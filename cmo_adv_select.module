<?php

/**
 * @file
 * Advanced Webform Select Option
 */

/**
 * Implements hook_form_alter().
 */
function cmo_adv_select_form_alter(&$form, &$form_state, $form_id){
  if(isset($form['#node'])){
    // Start Devel
    dsm($form);
    dsm($form_state);
    // End Devel
    
    $components = $form['#node']['webform']['components'];
    foreach ($components as $key => $component) {
      if($component['type'] === 'select'){
        //Grab selectors string
        $extra_items = $component['extra']['items'];
        //Split into options
        $items = split('\n', $extra_items);
        $its = array();
        //Split into key => value
        foreach ($items as $item) {
          $tmp = split('|', $item);
          $session = split('_', $tmp[0]);
          if(count($session) == 2 && is_int($session[1])){
            $values = array('session_name' => $session[0], 'session_copasity' => $session[1], 'session_details' => $tmp[1]);
            $its[$tmp[0]] = $values;
          } else {
            break;
          }
          
        }
        echo '<div>' . var_dump($its) . '</div';
      }
    }
  }
}
